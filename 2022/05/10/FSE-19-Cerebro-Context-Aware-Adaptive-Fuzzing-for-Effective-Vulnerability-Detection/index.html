<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"harperchen.github.io","root":"/blog/","images":"/blog/images","scheme":"Gemini","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/blog/js/config.js"></script>

    <meta name="description" content="Key: use complexity of uncovered code to foresee the benefits of fuzzing a seed (Input Potential)AbstractExisting greybox fuzzers mainly utilize program coverage as the goal to guide the fuzzing proce">
<meta property="og:type" content="article">
<meta property="og:title" content="[FSE&#39;19] Cerebro: Context-Aware Adaptive Fuzzing for Effective Vulnerability Detection">
<meta property="og:url" content="https://harperchen.github.io/blog/2022/05/10/FSE-19-Cerebro-Context-Aware-Adaptive-Fuzzing-for-Effective-Vulnerability-Detection/index.html">
<meta property="og:site_name" content="Wei&#39;s Blog">
<meta property="og:description" content="Key: use complexity of uncovered code to foresee the benefits of fuzzing a seed (Input Potential)AbstractExisting greybox fuzzers mainly utilize program coverage as the goal to guide the fuzzing proce">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-05-10T08:09:14.000Z">
<meta property="article:modified_time" content="2024-03-27T08:12:55.239Z">
<meta property="article:author" content="Wei CHEN">
<meta property="article:tag" content="Fuzzing">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://harperchen.github.io/blog/2022/05/10/FSE-19-Cerebro-Context-Aware-Adaptive-Fuzzing-for-Effective-Vulnerability-Detection/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://harperchen.github.io/blog/2022/05/10/FSE-19-Cerebro-Context-Aware-Adaptive-Fuzzing-for-Effective-Vulnerability-Detection/","path":"2022/05/10/FSE-19-Cerebro-Context-Aware-Adaptive-Fuzzing-for-Effective-Vulnerability-Detection/","title":"[FSE'19] Cerebro: Context-Aware Adaptive Fuzzing for Effective Vulnerability Detection"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[FSE'19] Cerebro: Context-Aware Adaptive Fuzzing for Effective Vulnerability Detection | Wei's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Wei's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#Key-use-complexity-of-uncovered-code-to-foresee-the-benefits-of-fuzzing-a-seed-Input-Potential"><span class="nav-number">1.</span> <span class="nav-text">Key: use complexity of uncovered code to foresee the benefits of fuzzing a seed (Input Potential)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Abstract"><span class="nav-number">2.</span> <span class="nav-text">Abstract</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Problem"><span class="nav-number">3.</span> <span class="nav-text">Problem</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Existing-work"><span class="nav-number">4.</span> <span class="nav-text">Existing work</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Drawback-of-existing-work"><span class="nav-number">5.</span> <span class="nav-text">Drawback of existing work</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Novelty"><span class="nav-number">6.</span> <span class="nav-text">Novelty</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Overview"><span class="nav-number">7.</span> <span class="nav-text">Overview</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Static-Analyzer"><span class="nav-number">7.1.</span> <span class="nav-text">Static Analyzer</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Dynamic-Scorer"><span class="nav-number">7.2.</span> <span class="nav-text">Dynamic Scorer</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Multi-objective-Scorer"><span class="nav-number">7.3.</span> <span class="nav-text">Multi-objective Scorer</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Power-Schqeduler"><span class="nav-number">7.4.</span> <span class="nav-text">Power Schqeduler</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wei CHEN"
      src="/blog/images/8.jpg">
  <p class="site-author-name" itemprop="name">Wei CHEN</p>
  <div class="site-description" itemprop="description">Be Brave; Be Confident; <br> Be Happy; Be Optimistic; </div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/blog/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/blog/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/harperchen" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;harperchen" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:harperchen1110@gmail.com" title="E-Mail → mailto:harperchen1110@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harperchen.github.io/blog/2022/05/10/FSE-19-Cerebro-Context-Aware-Adaptive-Fuzzing-for-Effective-Vulnerability-Detection/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/8.jpg">
      <meta itemprop="name" content="Wei CHEN">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei's Blog">
      <meta itemprop="description" content="Be Brave; Be Confident; <br> Be Happy; Be Optimistic; ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="[FSE'19] Cerebro: Context-Aware Adaptive Fuzzing for Effective Vulnerability Detection | Wei's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [FSE'19] Cerebro: Context-Aware Adaptive Fuzzing for Effective Vulnerability Detection
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-05-10 16:09:14" itemprop="dateCreated datePublished" datetime="2022-05-10T16:09:14+08:00">2022-05-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-27 16:12:55" itemprop="dateModified" datetime="2024-03-27T16:12:55+08:00">2024-03-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Papers/" itemprop="url" rel="index"><span itemprop="name">Papers</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h4 id="Key-use-complexity-of-uncovered-code-to-foresee-the-benefits-of-fuzzing-a-seed-Input-Potential"><a href="#Key-use-complexity-of-uncovered-code-to-foresee-the-benefits-of-fuzzing-a-seed-Input-Potential" class="headerlink" title="Key: use complexity of uncovered code to foresee the benefits of fuzzing a seed (Input Potential)"></a>Key: use complexity of uncovered code to foresee the benefits of fuzzing a seed (Input Potential)</h4><h4 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h4><p>Existing greybox fuzzers mainly utilize program coverage as the goal to guide the fuzzing process. To maximize their outputs, coveragebased greybox fuzzers need to evaluate the quality of seeds properly, which involves making two decisions: 1) which is the most promising seed to fuzz next (seed prioritization), and 2) how many efforts should be made to the current seed (power scheduling). In this paper, we present our fuzzer, Cerebro, to address the above challenges. For the seed prioritization problem, we propose an online<br>multi-objective based algorithm to balance various metrics such as code complexity, coverage, execution time, etc. To address the power scheduling problem, we introduce the concept of input potential to measure the complexity of uncovered code and propose a<br>cost-effective algorithm to update it dynamically. Unlike previous approaches where the fuzzer evaluates an input solely based on the execution traces that it has covered, Cerebro is able to foresee the benefits of fuzzing the input by adaptively evaluating its input potential. We perform a thorough evaluation for Cerebro on 8 different real-world programs. The experiments show that Cerebro can find more vulnerabilities and achieve better coverage than state-of-the-art fuzzers such as AFL and AFLFast.</p>
<span id="more"></span>
<h4 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h4><ol>
<li>Seed Prioritization</li>
<li>Power Scheduling</li>
</ol>
<h4 id="Existing-work"><a href="#Existing-work" class="headerlink" title="Existing work"></a>Existing work</h4><ol>
<li>Seed Prioritization: path rarity (AFLFast) or code complexity</li>
<li>Power Scheduing: singal objective or mix several objectives via weighted sum</li>
</ol>
<h4 id="Drawback-of-existing-work"><a href="#Drawback-of-existing-work" class="headerlink" title="Drawback of existing work"></a>Drawback of existing work</h4><ol>
<li>Seed Prioritization: Not aware of uncovered code close to the execution trace</li>
<li>Power Scheduling<ol>
<li>single objective is bias;</li>
<li>weighted sum is empirically decided</li>
</ol>
</li>
</ol>
<h4 id="Novelty"><a href="#Novelty" class="headerlink" title="Novelty"></a>Novelty</h4><ol>
<li>Input potential for Power scheduling: the complexity of not yet covered code near the execution trace of the input</li>
<li>Multi-objective optimization for Seed prioritization: balance various metrics such as code complexity, coverage, execution time, etc.</li>
</ol>
<h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><h5 id="Static-Analyzer"><a href="#Static-Analyzer" class="headerlink" title="Static Analyzer"></a>Static Analyzer</h5><p>方法：scan throughout the source code and calculates a complexity score for each function</p>
<ol>
<li>结构复杂度：McCabe’s Cyclomatic Complexity （根据边和节点）</li>
<li>操作码复杂度：Halstead Complexity Measures （根据操作码）</li>
</ol>
<p>静态复杂度 &#x3D;（结构复杂度+操作码复杂度）* 100 &#x2F; 2</p>
<p>以静态复杂度初始化动态潜在分数</p>
<h5 id="Dynamic-Scorer"><a href="#Dynamic-Scorer" class="headerlink" title="Dynamic Scorer"></a>Dynamic Scorer</h5><p>动态潜在分数：所有后继函数能够带来的潜在奖励的和，若某函数已覆盖则不作数</p>
<p>组合分数 &#x3D; 静态分数+动态分数</p>
<h5 id="Multi-objective-Scorer"><a href="#Multi-objective-Scorer" class="headerlink" title="Multi-objective Scorer"></a>Multi-objective Scorer</h5><p>针对每个seed，多目标标准：</p>
<ol>
<li>文件大小：越小越好</li>
<li>执行时间: 越短越好</li>
<li>覆盖的边数：越多越好</li>
<li>是否带来新代码覆盖率：有新代码覆盖率更好</li>
<li>执行序列的静态复杂度：越复杂的代码越容易出错</li>
</ol>
<h5 id="Power-Schqeduler"><a href="#Power-Schqeduler" class="headerlink" title="Power Schqeduler"></a>Power Schqeduler</h5><p>每个seed的组合分数</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/Fuzzing/" rel="tag"># Fuzzing</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/blog/2022/04/29/Kernel-Coverage-Analysis/" rel="prev" title="Kernel Coverage Analysis">
                  <i class="fa fa-angle-left"></i> Kernel Coverage Analysis
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/blog/2022/05/20/USENIX-22-SyzScope-Revealing-High-Risk-Security-Impacts-of-Fuzzer-Exposed-Bugs-in-Linux-kernel/" rel="next" title="[USENIX'22] SyzScope: Revealing High-Risk Security Impacts of Fuzzer-Exposed Bugs in Linux kernel">
                  [USENIX'22] SyzScope: Revealing High-Risk Security Impacts of Fuzzer-Exposed Bugs in Linux kernel <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Wei CHEN</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/next-boot.js"></script>

  






  





</body>
</html>
