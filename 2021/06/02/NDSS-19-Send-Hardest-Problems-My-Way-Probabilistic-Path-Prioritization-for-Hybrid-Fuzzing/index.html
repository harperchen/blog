<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"harperchen.github.io","root":"/blog/","images":"/blog/images","scheme":"Gemini","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/blog/js/config.js"></script>

    <meta name="description" content="AbstractHybrid fuzzing which combines fuzzing and concolic execution has become an advanced technique for software vulnerability detection. Based on the observation that fuzzing and concolic execution">
<meta property="og:type" content="article">
<meta property="og:title" content="[NDSS&#39;19] Send Hardest Problems My Way: Probabilistic Path Prioritization for Hybrid Fuzzing">
<meta property="og:url" content="https://harperchen.github.io/blog/2021/06/02/NDSS-19-Send-Hardest-Problems-My-Way-Probabilistic-Path-Prioritization-for-Hybrid-Fuzzing/index.html">
<meta property="og:site_name" content="Wei&#39;s Blog">
<meta property="og:description" content="AbstractHybrid fuzzing which combines fuzzing and concolic execution has become an advanced technique for software vulnerability detection. Based on the observation that fuzzing and concolic execution">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2021/06/03/XCMB3LGHpJqTInV.png">
<meta property="og:image" content="https://i.loli.net/2021/06/03/Oa8UxcMWiegknoZ.png">
<meta property="og:image" content="https://i.loli.net/2021/06/03/L64HtKV3p1qiPvj.png">
<meta property="og:image" content="https://i.loli.net/2021/06/04/xnkqJQc1EMNijvt.png">
<meta property="article:published_time" content="2021-06-02T09:52:28.000Z">
<meta property="article:modified_time" content="2024-03-27T05:21:36.068Z">
<meta property="article:author" content="Wei CHEN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/06/03/XCMB3LGHpJqTInV.png">


<link rel="canonical" href="https://harperchen.github.io/blog/2021/06/02/NDSS-19-Send-Hardest-Problems-My-Way-Probabilistic-Path-Prioritization-for-Hybrid-Fuzzing/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://harperchen.github.io/blog/2021/06/02/NDSS-19-Send-Hardest-Problems-My-Way-Probabilistic-Path-Prioritization-for-Hybrid-Fuzzing/","path":"2021/06/02/NDSS-19-Send-Hardest-Problems-My-Way-Probabilistic-Path-Prioritization-for-Hybrid-Fuzzing/","title":"[NDSS'19] Send Hardest Problems My Way: Probabilistic Path Prioritization for Hybrid Fuzzing"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[NDSS'19] Send Hardest Problems My Way: Probabilistic Path Prioritization for Hybrid Fuzzing | Wei's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Wei's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Abstract"><span class="nav-number">1.</span> <span class="nav-text">Abstract</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Outline"><span class="nav-number">2.</span> <span class="nav-text">Outline</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Question-How-to-combine-fuzzing-and-concolic-execution"><span class="nav-number">2.1.</span> <span class="nav-text">Question: How to combine fuzzing and concolic execution</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Drawback-of-exsiting-strategy"><span class="nav-number">2.2.</span> <span class="nav-text">Drawback of exsiting strategy</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Novelty-Design-principle-for-building-a-hybrid-fuzzing-system"><span class="nav-number">2.3.</span> <span class="nav-text">Novelty: Design principle for building a hybrid fuzzing system</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Key-Challenge-How-to-quantify-the-difficulty-level-for-each-path"><span class="nav-number">2.4.</span> <span class="nav-text">Key Challenge: How to quantify the difficulty level for each path</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Theoretical-Model-Monte-Carlo"><span class="nav-number">2.5.</span> <span class="nav-text">Theoretical Model: Monte Carlo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Implementation-DigFuzz"><span class="nav-number">2.6.</span> <span class="nav-text">Implementation: DigFuzz</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Evaluation"><span class="nav-number">2.7.</span> <span class="nav-text">Evaluation</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wei CHEN"
      src="/blog/images/8.jpg">
  <p class="site-author-name" itemprop="name">Wei CHEN</p>
  <div class="site-description" itemprop="description">Be Brave; Be Confident; <br> Be Happy; Be Optimistic; </div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/blog/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/blog/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/harperchen" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;harperchen" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:harperchen1110@gmail.com" title="E-Mail → mailto:harperchen1110@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harperchen.github.io/blog/2021/06/02/NDSS-19-Send-Hardest-Problems-My-Way-Probabilistic-Path-Prioritization-for-Hybrid-Fuzzing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/8.jpg">
      <meta itemprop="name" content="Wei CHEN">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wei's Blog">
      <meta itemprop="description" content="Be Brave; Be Confident; <br> Be Happy; Be Optimistic; ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="[NDSS'19] Send Hardest Problems My Way: Probabilistic Path Prioritization for Hybrid Fuzzing | Wei's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [NDSS'19] Send Hardest Problems My Way: Probabilistic Path Prioritization for Hybrid Fuzzing
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-06-02 17:52:28" itemprop="dateCreated datePublished" datetime="2021-06-02T17:52:28+08:00">2021-06-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-27 13:21:36" itemprop="dateModified" datetime="2024-03-27T13:21:36+08:00">2024-03-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h3 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h3><p>Hybrid fuzzing which combines fuzzing and concolic execution has become an advanced technique for software vulnerability detection. Based on the observation that fuzzing and concolic execution are complementary in nature, the state-of-theart hybrid fuzzing systems deploy “demand launch” and “optimal switch” strategies. Although these ideas sound intriguing, we point out several fundamental limitations in them, due to oversimplified assumptions. We then propose a novel “discriminative dispatch” strategy to better utilize the capability of concolic execution. We design a Monte Carlo based probabilistic path prioritization model to quantify each path’s difficulty and prioritize them for concolic execution. This model treats fuzzing as a random sampling process. It calculates each path’s probability based on the sampling information. Finally, our model prioritizes and assigns the most difficult paths to concolic execution. We implement a prototype system DigFuzz and evaluate our system with two representative datasets. Results show that the concolic execution in DigFuzz outperforms than those in state-of-the-art hybrid fuzzing systems in every major aspect. In particular, the concolic execution in DigFuzz contributes to discovering more vulnerabilities (12 vs. 5) and producing more code coverage (18.9% vs. 3.8%) on the CQE dataset than the concolic execution in Driller.</p>
<span id="more"></span>

<h3 id="Outline"><a href="#Outline" class="headerlink" title="Outline"></a>Outline</h3><h4 id="Question-How-to-combine-fuzzing-and-concolic-execution"><a href="#Question-How-to-combine-fuzzing-and-concolic-execution" class="headerlink" title="Question: How to combine fuzzing and concolic execution"></a>Question: How to combine fuzzing and concolic execution</h4><ol>
<li><p>Demand launch: Driller, hybrid concolic testing</p>
<p>Fuzzing starts first and concolic execution is launched only when fuzzing cannot make any progress for a certain period of time, a.k.a., stuck</p>
</li>
<li><p>Optimal Switch</p>
<p>Quantify the costs for exploring each path by fuzzing and concolic execution respectively and choose the more economic method for exploring the path</p>
</li>
</ol>
<h4 id="Drawback-of-exsiting-strategy"><a href="#Drawback-of-exsiting-strategy" class="headerlink" title="Drawback of exsiting strategy"></a>Drawback of exsiting strategy</h4><p>Athough existing strategies sound intriguing, none of them work adequately, due to unrealistic or oversimplified assumptions.</p>
<ol>
<li>Demand Launch<ul>
<li>Fuzzing is making progress does not necessarily mean concolic execution is not needed.</li>
<li>This strategy does not recognize specific paths that block fuzzing.  Once the fuzzer gets stuck, the demand launch strategy feeds all seeds retained by the fuzzer to concolic execution for exploring all missed paths</li>
</ul>
</li>
<li>Optimal Switch<ul>
<li>Nontrivial to quantify the costs of fuzzing and concolic execution for each path</li>
<li>Hard to normalize the cost of concolic execution and fuzzing  for a unified comparison, because these two costs are estimated by techniques with different metrics.</li>
</ul>
</li>
</ol>
<h4 id="Novelty-Design-principle-for-building-a-hybrid-fuzzing-system"><a href="#Novelty-Design-principle-for-building-a-hybrid-fuzzing-system" class="headerlink" title="Novelty: Design principle for building a hybrid fuzzing system"></a>Novelty: Design principle for building a hybrid fuzzing system</h4><ol>
<li>Let concolic execution solve the hardest problems</li>
<li>Let fuzzing take the majority task of path exploration</li>
<li>Extra analysis must be lightweight to avoid adverse impact on the throughput</li>
</ol>
<p><font color="#dd0000"><strong>Discriminative dispatch</strong></font>: Prioritize paths so that concolic execution <em>only</em> works on selective paths that are <em>most</em> difficult for fuzzing to break through</p>
<h4 id="Key-Challenge-How-to-quantify-the-difficulty-level-for-each-path"><a href="#Key-Challenge-How-to-quantify-the-difficulty-level-for-each-path" class="headerlink" title="Key Challenge: How to quantify the difficulty level for each path"></a>Key Challenge: How to quantify the difficulty level for each path</h4><ol>
<li>Existing work perform expensive program analysis  to evaluate the difficulty<ul>
<li>symbolic execution</li>
<li>value analysis</li>
</ul>
</li>
<li><font color="#006600"><strong>Quantify a path’s difficulty by its probability of how likely a random input can traverse this path.</strong></font><ul>
<li>Treat fuzzing as a random sampling process</li>
<li>Calculate each path’s probability based on the sampling information.</li>
</ul>
</li>
</ol>
<h4 id="Theoretical-Model-Monte-Carlo"><a href="#Theoretical-Model-Monte-Carlo" class="headerlink" title="Theoretical Model: Monte Carlo"></a>Theoretical Model: Monte Carlo</h4><p>Calculate the probability of a path to be explored by fuzzing. </p>
<p>Fuzzing could fulfill two requirement of conducting Monte Carlo method:</p>
<ul>
<li>fuzzing randomly generate inputs for testing programs &#x3D;&gt; sampling to the search space is random</li>
<li>fuzzing has a very high throughput &#x3D;&gt; a large number of random sampling for estimation</li>
</ul>
<p>How to calculate the probability for <font color="blue"><strong>each branch</strong></font></p>
<img src="https://i.loli.net/2021/06/03/XCMB3LGHpJqTInV.png" alt="image-20210603221145158" style="zoom:45%;" />

<p>How to calculate the probability of <font color="Darkorange"><strong>each path</strong></font></p>
<img src="https://i.loli.net/2021/06/03/Oa8UxcMWiegknoZ.png" alt="image-20210603221825939" style="zoom:45%;" />

<h4 id="Implementation-DigFuzz"><a href="#Implementation-DigFuzz" class="headerlink" title="Implementation: DigFuzz"></a>Implementation: DigFuzz</h4><p><img src="https://i.loli.net/2021/06/03/L64HtKV3p1qiPvj.png" alt="image-20210603222727877"></p>
<p><strong>Step 1: Execution Sampling</strong> </p>
<p>Input: Program, Fuzzer, Initial Seed</p>
<p>Output: HashMap of Coverage, Corpus</p>
<p>Perform execution sampling to collect coverage statistics which indicate how many times each branch is covered during the sampling.</p>
<p>**Step 2: Execution Tree Construction **</p>
<p>Input: Control flow graph, HashMap of Coverage, Corpus</p>
<p>Outputput: Execution Tree with Prob</p>
<p>Note: Only perform trace analysis for seed ratained by fuzzing to avoid path explosion</p>
<p><strong>Step 3: Probabilistric Path Prioritization</strong></p>
<p>Input: Execution Tree</p>
<p>Output: A set of missed paths and their probability</p>
<p>Prioritizes all the missed paths in the tree, and identifies the paths with the lowest probability for concolic execution.</p>
<img src="https://i.loli.net/2021/06/04/xnkqJQc1EMNijvt.png" alt="image-20210604173949532" style="zoom:40%;" />

<h4 id="Evaluation"><a href="#Evaluation" class="headerlink" title="Evaluation"></a>Evaluation</h4><p>DataSet: CQE, LAVA-M</p>
<p>Metrics: coverage, vulnerability, contribution of concolic execution</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/blog/2021/05/31/Tool-Angr-Binary-Analysis/" rel="prev" title="[Tool] Angr Binary Analysis">
                  <i class="fa fa-angle-left"></i> [Tool] Angr Binary Analysis
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/blog/2021/06/04/Tool-SVF-Static-Analysis/" rel="next" title="[Tool] SVF Static Analysis">
                  [Tool] SVF Static Analysis <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Wei CHEN</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/next-boot.js"></script>

  






  





</body>
</html>
